(window.webpackJsonp=window.webpackJsonp||[]).push([[45],{419:function(s,t,a){"use strict";a.r(t);var n=a(11),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"微件定制"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#微件定制"}},[s._v("#")]),s._v(" 微件定制")]),s._v(" "),a("p",[s._v("全空间一张图框架支持使用运行时加载微件插件包，支持微件的独立定制开发。")]),s._v(" "),a("h2",{attrs:{id:"获取微件脚手架项目"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#获取微件脚手架项目"}},[s._v("#")]),s._v(" 获取微件脚手架项目")]),s._v(" "),a("p",[s._v("您可以在 Gitee 上下拉"),a("a",{attrs:{href:"https://gitee.com/osmapgis/MapGIS-Pan-Spatial-Map-Widgets-Frame",target:"_blank",rel:"noopener noreferrer"}},[s._v("MapGIS-Pan-Spatial-Map-Widgets-Frame"),a("OutboundLink")],1),s._v("代码。\n或者在 Github 上下拉"),a("a",{attrs:{href:"https://github.com/MapGIS/MapGIS-Pan-Spatial-Map-Widgets-Frame",target:"_blank",rel:"noopener noreferrer"}},[s._v("MapGIS-Pan-Spatial-Map-Widgets-Frame"),a("OutboundLink")],1),s._v("代码。")]),s._v(" "),a("p",[a("strong",[s._v("建议将 MapGIS-Pan-Spatial-Map-Widgets-Frame 的源码和 MapGIS-Pan-Spatial-Map 的源码放在同一个目录下，方便后续的实时开发")])]),s._v(" "),a("p",[s._v("在 MapGIS-Pan-Spatial-Map-Widgets-Frame 源码根目录下运行命令：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v("         "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装依赖")]),s._v("\n")])])]),a("h2",{attrs:{id:"新增微件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#新增微件"}},[s._v("#")]),s._v(" 新增微件")]),s._v(" "),a("p",[s._v("脚手架中添加了快速添加微件的脚本命令，以减少开发者开发时的重复工作。")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("在 MapGIS-Pan-Spatial-Map-Widgets-Frame 源码根目录下执行快速添加微件脚本命令。")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v(" add:widget\n")])])])]),s._v(" "),a("li",[a("p",[s._v("根据提示输入信息")]),s._v(" "),a("img",{attrs:{src:s.$withBase("/images/微件创建向导.png"),alt:"微件创建向导"}})]),s._v(" "),a("li",[a("p",[s._v("通过向导生成目录结构")]),s._v(" "),a("p",[s._v("根据向导操作后生成如下目录，微件内容则需要开发者自行编写")]),s._v(" "),a("img",{attrs:{src:s.$withBase("/images/微件创建目录结构.png"),alt:"微件创建目录结构"}})]),s._v(" "),a("li",[a("p",[s._v("添加微件的配置信息")]),s._v(" "),a("p",[s._v("在 widgets 文件夹中，我们需要对微件的信息进行配置，让项目在加载的时候能够进行准确的识别和加载。")]),s._v(" "),a("p",[s._v("微件配置文件需要自己手动创建，可以将示例里的配置文件复制到新微件对应的文件夹中，并修改配置文件中的内容。")]),s._v(" "),a("img",{attrs:{src:s.$withBase("/images/微件配置.png"),alt:"微件配置"}}),s._v(" "),a("p",[s._v("微件配置文件为 manifest.json，微件的数据配置文件为 config.json。")])])]),s._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// manifest.json")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// widget的标识名称，需要与widget文件夹的名称一致")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"name"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test-widget"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// widget的作者")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"author"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"MapGIS"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// widget的描述")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"description"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// widget的描述")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"description"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// widget的组件名，如果inPanel为false，则表示使用widget本身UI，")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 如果inPanel为true，其icon会显示到地图占位区域或内容区域中，widget本身UI会展示到对应面板中")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"component"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"TestWidget"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// widget图标")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"icon"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"<svg class=\\"icon\\" viewBox=\\"0 0 1024 1024\\" xmlns=\\"http://www.w3.org/2000/svg\\" width=\\"200\\" height=\\"200\\"><defs><style/></defs><path d=\\"M897.706667 1023.573333H178.346667l421.546666-506.026666c180.48 117.76 297.813333 300.373333 297.813334 506.026666z m0-1021.866666H131.413333v919.466666z\\"/></svg>"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// widget属性表")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"properties"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 确定widget是否支持2D，默认为true")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"2D"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 确定widget是否支持3D，默认为false")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"3D"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 设置widget是否inPanel，如果不在一个panel中，widget会直接展示，默认为true")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"inPanel"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 设置为true的话，默认加载config文件，反之不加载，默认为true")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"hasConfig"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 设为为true的话，builder会加载setting页。如果为false并且widget可配置则展示一个Json编辑器")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"hasSettingPage"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 如果有setting页，settingUiComponent表示设置页ui的组件名")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"settingUiComponent"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"WidgetExampleSetting"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 确定widget的窗口大小，默认为normal，可设置为normal（常规的，由panel决定）、max（最大化），可不设置")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"windowSize"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"normal"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 自定义widget面板的宽度，Number格式，在经典主题下工具条微件所属面板默认为320，左侧微件所属面板默认为280，可不设置")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"customWidth"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("280")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 确定widget的窗口是否有边距，默认为true，可设置为false，可不设置")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"hasPadding"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 设置微件是否懒加载，默认为false，当为true的时候，会在打开微件面板时才会去加载微件，可通过此特性控制初始加载的微件数和内存大小")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"lazyload"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 设置微件是否有UI，默认为true，当inPanel为false且hasUi也为false时，会自动加载该微件，并由内容区域负责该微件的标识和响应")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"hasUi"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 微件对应的js文件路径")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"jsFile"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"widget.js"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 微件对应的css文件路径")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"cssFile"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"widget.css"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 微件配置页面对应的js文件路径")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"settingJsFile"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"setting.js"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 微件配置页面对应的css文件路径")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"settingCssFile"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"setting.css"')]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// config.json")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),a("ul",[a("li",[a("p",[s._v("打包")]),s._v(" "),a("p",[s._v("以上工作完成后执行打包命令将项目进行打包。")])])]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v(" build          "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 正常打包，用于生产环境")]),s._v("\n\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v(" build:debug    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 调试打包，用于开发环境")]),s._v("\n")])])]),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("提示")]),s._v(" "),a("p",[s._v("打包前，应在 vue.config.js 中将 Webclient Vue 组件包和 Webclient JS 相关包排除，以减少打包后的文件大小。")]),s._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 在 vue.config.js 中将 Webclient Vue 组件包和 Webclient JS 相关包排除示例")]),s._v("\nconfigureWebpack"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    externals"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'@mapgis/web-app-framework'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'@mapgis/web-app-framework'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'@mapgis/cesium'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'@mapgis/cesium'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'@mapgis/geojson-vt'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'@mapgis/geojson-vt'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'@mapgis/mapbox-gl'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'@mapgis/mapbox-gl'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'@mapgis/mapbox-gl-compare'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'@mapgis/mapbox-gl-compare'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'@mapgis/mapbox-gl-draw'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'@mapgis/mapbox-gl-draw'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'@mapgis/mapbox-gl-draw-circle'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'@mapgis/mapbox-gl-draw-circle'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'@mapgis/mapbox-gl-draw-radius'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'@mapgis/mapbox-gl-draw-radius'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'@mapgis/mapbox-gl-draw-static-mode'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'@mapgis/mapbox-gl-draw-static-mode'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'@mapgis/mapbox-gl-inspect'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'@mapgis/mapbox-gl-inspect'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'@mapgis/supercluster'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'@mapgis/supercluster'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'@mapgis/webclient-cesium-plugin'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'@mapgis/webclient-cesium-plugin'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'@mapgis/webclient-common'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'@mapgis/webclient-common'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'@mapgis/webclient-es6-mapboxgl'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'@mapgis/webclient-es6-mapboxgl'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'@mapgis/webclient-es6-service'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'@mapgis/webclient-es6-service'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'@mapgis/webclient-plot'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'@mapgis/webclient-plot'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'@mapgis/webclient-store'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'@mapgis/webclient-store'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'@mapgis/webclient-vue-ui'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'@mapgis/webclient-vue-ui'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'@mapgis/webclient-vue-mapboxgl'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'@mapgis/webclient-vue-mapboxgl'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'@mapgis/webclient-vue-cesium'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'@mapgis/webclient-vue-cesium'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n")])])]),a("p",[s._v("由于在全空间一张图中已经引用了@mapgis/web-app-framework，而@mapgis/web-app-framework 的 package.json 中已引入了 Webclient Vue 组件包，比如@mapgis/webclient-vue-cesium、@mapgis/webclient-vue-mapboxgl、@mapgis/webclient-vue-ui 等，而 Webclient Vue 组件包的 package.json 中会引入 Webclient JS 相关包，因此，在 MapGIS-Pan-Spatial-Map 主应用中会有 Webclient Vue 和 Webclient JS 相关包的依赖。")])]),s._v(" "),a("ul",[a("li",[a("p",[s._v("项目打包")]),s._v(" "),a("p",[s._v("执行打包脚本后，项目源码目录下会新增 dist-libs 文件夹，打包后生成的微件 js 和 css 文件默认放在第一个微件文件夹中。")]),s._v(" "),a("p",[s._v('如果有多个微件，非第一个微件的其他微件的 manifest.json 文件中的 properties 属性需要指向第一个微件文件夹，如"widgets/test-widget/widget.js"。\n'),a("img",{attrs:{src:s.$withBase("/images/微件打包.png"),alt:"微件打包"}})]),s._v(" "),a("p",[s._v("如果只需要非第一个微件的其他某一个微件，可以将打包后生成的微件 js 和 css 文件从第一个微件文件夹中复制到该微件对应的文件夹下，并参考第一个微件的 manifest.json 文件中的 properties 属性配置 theme.js 和 theme.css 路径，然后打包成 zip 即可。")]),s._v(" "),a("img",{attrs:{src:s.$withBase("/images/微件打包zip.png"),alt:"微件打包zip"}})]),s._v(" "),a("li",[a("p",[s._v("项目使用")]),s._v(" "),a("p",[s._v("在全空间一张图管理平台"),a("strong",[s._v("应用管理/微件管理")]),s._v("中导入上述微件包(zip)。\n"),a("img",{attrs:{src:s.$withBase("/images/导入微件.png"),alt:"导入微件"}}),s._v(" "),a("img",{attrs:{src:s.$withBase("/images/导入微件结果.png"),alt:"导入微件结果"}})]),s._v(" "),a("p",[s._v("上传成功后通过功能菜单"),a("strong",[s._v("应用管理-应用搭建")]),s._v("对微件进行配置，保存后登录全空间一张图即可看到微件效果。\n"),a("img",{attrs:{src:s.$withBase("/images/导入微件应用搭建.png"),alt:"导入微件应用搭建"}}),s._v(" "),a("img",{attrs:{src:s.$withBase("/images/导入微件显示效果.png"),alt:"导入微件显示效果"}})])])]),s._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("提示")]),s._v(" "),a("p",[s._v("若需要对以此种方式加载的微件进行调试，只需要执行调试打包脚本命令，将对应微件上传应用后进入全空间一张图，打开控制台正常调试即可")])]),s._v(" "),a("h2",{attrs:{id:"微件实时开发"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#微件实时开发"}},[s._v("#")]),s._v(" 微件实时开发")]),s._v(" "),a("p",[s._v("1、在 MapGIS-Pan-Spatial-Map-Widgets-Frame 源码根目录下运行命令：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v("         "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装依赖")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v(" unlink  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 取消 link 项目到全局，如果之前没有link过该项目，这一步可以省略")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("link")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# link 项目到全局")]),s._v("\n")])])]),a("p",[s._v("2、在 MapGIS-Pan-Spatial-Map/src/core/use.js 中引用@mapgis/MapGIS-Pan-Spatial-Map-Widgets-Frame。\n"),a("img",{attrs:{src:s.$withBase("/images/导入微件实时开发引入.png"),alt:"导入微件实时开发引入"}})]),s._v(" "),a("p",[s._v('3、修改所有新增微件的配置文件 manifest.json，去掉"properties"属性中"jsFile"、"cssFile"、"settingJsFile"、"settingCssFile"的值，然后保存。删除 widget.js 和 widget.css 文件，重新打包 zip 包。\n'),a("img",{attrs:{src:s.$withBase("/images/微件打包删除js实时开发.png"),alt:"微件打包删除js实时开发"}})]),s._v(" "),a("p",[s._v("4、在全空间一张图管理平台"),a("strong",[s._v("应用管理/微件管理")]),s._v("中导入上述微件包(zip)，勾选“是否更新已经存在的微件数据”。\n"),a("img",{attrs:{src:s.$withBase("/images/导入微件结果实时开发.png"),alt:"导入微件结果实时开发"}})]),s._v(" "),a("p",[s._v("5、上传成功后通过功能菜单"),a("strong",[s._v("应用管理-应用搭建")]),s._v("对微件进行配置，并保存。")]),s._v(" "),a("p",[s._v("6、在 MapGIS-Pan-Spatial-Map 源码根目录下运行命令：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("link")]),s._v(" @mapgis/MapGIS-Pan-Spatial-Map-Widgets-Frame  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# link MapGIS-Pan-Spatial-Map-Widgets-Frame插件包")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v(" serve                                            "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 编译工程")]),s._v("\n")])])]),a("p",[s._v("经过以上步骤，MapGIS-Pan-Spatial-Map-Widgets-Frame 插件包即已成功运行。\n"),a("img",{attrs:{src:s.$withBase("/images/导入微件实时开发.png"),alt:"导入微件实时开发"}})])])}),[],!1,null,null,null);t.default=e.exports}}]);